function [N, dNdz] = cube(z)

    z1 = z(:,1);
    z2 = z(:,2);
    z3 = z(:,3);

    N = [ -(z1-1)*(z2-1)*(z3-1)
           (z1+1)*(z2-1)*(z3-1)
          -(z1+1)*(z2-1)*(z3-1)
           (z1-1)*(z2+1)*(z3-1)
           (z1-1)*(z2-1)*(z3+1)
          -(z1+1)*(z2-1)*(z3+1)
           (z1+1)*(z2+1)*(z3+1)
          -(z1-1)*(z2+1)*(z3+1)]/8;

    dNdz = [ -(z2-1)*(z3-1) -(z1-1)*(z3-1) -(z1-1)*(z2-1)
              (z2-1)*(z3-1)  (z1+1)*(z3-1)  (z1+1)*(z2-1)
             -(z2-1)*(z3-1) -(z1+1)*(z3-1) -(z1+1)*(z2-1)
              (z2+1)*(z3-1)  (z1-1)*(z3-1)  (z1-1)*(z2+1)
              (z2-1)*(z3+1)  (z1-1)*(z3+1)  (z1-1)*(z2-1)
             -(z2-1)*(z3+1) -(z1+1)*(z3+1) -(z1+1)*(z2-1)
              (z2+1)*(z3+1)  (z1+1)*(z3+1)  (z1+1)*(z2+1)
             -(z2+1)*(z3+1) -(z1-1)*(z3+1) -(z1-1)*(z2+1)
            ]/8;
    
end
